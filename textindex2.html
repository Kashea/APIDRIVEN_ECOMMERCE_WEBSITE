<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <title>Document</title>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="#">Navbar</a>
      <ul class="navbar-nav">
        <li class="nav-item dropdown mx-2 mx-lg-0 px-3 px-lg-0">
          <a class="nav-link position-relative dropdown-toggle no-caret" href="#" id="cartDropdown" role="button"
            data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-no">0</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end mt-3 py-0" aria-labelledby="cartDropdown">
            <li>
              <div class="d-flex flex-column px-3 pt-3 pb-2 border-bottom cart-item">
                <div class="d-flex justify-content-between">
                  <div class="d-flex">
                    <img class="img-fluid me-2" src="https://via.placeholder.com/60x60" alt="">
                    <div class="d-flex flex-column">
                      <h6 class="mb-1"><a href="#">Product name</a></h6>
                      <span class="text-muted text-small">$20.00</span>
                    </div>
                  </div>
                  <a href="#" class="cart-item-remove"><i class="fas fa-times"></i></a>
                </div>
                <div class="d-flex align-items-center mt-3">
                  <div class="input-group input-group-sm mb-0">
                    <button class="btn btn-outline-secondary" type="button" id="button-addon1">-</button>
                    <input type="text" class="form-control cart-item-quantity" placeholder=""
                      aria-label="Example text with button addon" aria-describedby="button-addon1" value="1">
                    <button class="btn btn-outline-secondary" type="button" id="button-addon2">+</button>
                  </div>
                  <span class="cart-item-total ms-3">$20.00</span>
                </div>
              </div>
            </li>
            <li>
              <div class="d-flex justify-content-between px-3 pt-3 pb-2 border-bottom">
                <span>Total:</span>
                <span class="fw-bold cart-total">$0.00</span>
              </div>
            </li>
            <li>
              <div class="d-flex justify-content-center px-3 pt-3 pb-3">
                <a href="#" class="btn btn-primary w-100">Proceed to checkout</a>
              </div>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Swiper -->
  <div class="swiper-slide">
    <div class="product mb-5">
      <!-- ... -->
      <div class="pt-3">
        <a class="reset-anchor" href="detail.html">
          <h3 class="h6 mb-0 text-uppercase">Elegant Lake</h3>
        </a>
        <span class="text-muted">$40.00</span>
        <button class="btn btn-primary" onclick="addToCart(1, 'Elegant Lake', 40)">Add to cart</button>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <script>
    const apiUrl = 'https://fakeapi.platzi.com';
    const cart = {};

    function addToCart(id, name, price) {
      if (cart[id]) {
        alert('Item is already added');
      } else {
        cart[id] = {
          name: name,
          price: price,
          quantity: 1,
          total: price
        };
        addCartItem(id, name, price);
      }
    }

    function addCartItem(id, name, price) {
      const cartItem = document.createElement('div');
      cartItem.className = 'dropdown-item d-flex align-items-center';
      cartItem.innerHTML = `
        <img src="https://via.placeholder.com/50x50" class="rounded me-3" alt="${name}">
        <div>
          <h6 class="m-0">${name}</h6>
          <p class="m-0">$${price}</p>
        </div>
        <div class="ms-auto">
          <input type="number" class="form-control form-control-sm w-50" value="1" min="1" onchange="updateCartItemTotal(${id}, ${price}, this)">
          <button class="btn btn-sm btn-danger" onclick="removeCartItem(${id})">Remove</button>
        </div>
      `;
      document.getElementById('cart-dropdown').appendChild(cartItem);
      updateCartIcon();
    }

    function updateCartItemTotal(id, price, input) {
      const quantity = parseInt(input.value);
      if (quantity < 1) {
        input.value = 1;
        alert('Quantity cannot be less than 1');
      } else {
        cart[id].quantity = quantity;
        cart[id].total = price * quantity;
      }
    }

    function removeCartItem(id) {
      delete cart[id];
      const cartDropdown = document.getElementById('cart-dropdown');
      cartDropdown.innerHTML = '';
      for (const key in cart) {
        addCartItem(key, cart[key].name, cart[key].price);
      }
      updateCartIcon();
    }

    function updateCartIcon() {
      const badge = document.getElementById('cart-badge');
      badge.textContent = Object.keys(cart).length;
    }

    async function fetchSwiperItems() {
      try {
        const response = await fetch(`${apiUrl}/api/products`);
        const data = await response.json();

        const swiperWrapper = document.getElementById('swiper-wrapper');
        data.slice(0, 72).forEach(item => {
          const swiperSlide = document.createElement('div');
          swiperSlide.className = 'swiper-slide';
          swiperSlide.innerHTML = `
            <div class="card" style="width: 18rem;">
              <img src="${item.image}" class="card-img-top" alt="${item.name}">
              <div class="card-body">
                <h5 class="card-title">${item.name}</h5>
                <p class="card-text">$${item.price}</p>
                <button class="btn btn-primary" onclick="addToCart(${item.id}, '${item.name}', ${item.price})">Add to cart</button>
              </div>
            </div>
          `;
          swiperWrapper.appendChild(swiperSlide);
        });

        new Swiper('.swiper-container', {
          slidesPerView: 4,
          spaceBetween: 10,
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      } catch (error) {
        console.error('Failed to fetch swiper items:', error);
      }
    }

    fetchSwiperItems();
  </script>
</body>

</html>